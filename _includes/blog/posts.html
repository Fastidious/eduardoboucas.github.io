{% if paginator.page %}
  {% assign offset = paginator.page | minus:1 | times:paginator.per_page %}
{% else %}
  {% assign offset = 0 %}
{% endif %}

<div id="blogContainer" class="postContainer" data-page="1" data-totalPages="{{ paginator.total_pages }}">
  {% for post in site.posts limit:site.paginate offset:offset %}
    <article class="post list">
      <header>
        <a class="readPost" href="{{ post.url | prepend: site.baseurl }}"><h1>{{ post.title }}</h1></a>
        <p class="postMeta">
          <span class="date"><img src="/assets/images/icons/time.svg" class="postIcon"/> {{ post.date | date: "%b %-d, %Y" }}</span>
          {% if post.tags %}
            <span class="tags"><img src="/assets/images/icons/tag.svg" class="postIcon"/> {% for tag in post.tags %} <em>{{ tag }}</em>{% endfor %}</span>
          {% endif %}
          <span class="permalink"><img src="/assets/images/icons/link.svg" class="postIcon"/> <a href="{{ post.url }}">Permalink</a></span>
        </p>
      </header>
      <div class="excerpt">
        {% if post.content contains '<!--more-->' %}
          <a class="readPost" href="{{ post.url }}">{{ post.content | split:'<!--more-->' | first }}</a>
          <p class="cta"><a class="readPost" href="{{ post.url }}">Read full post &#8594;</a></p>
        {% else %}
          {{ post.content }}
        {% endif %}
      </div>
    </article>
  {% endfor %}
</div>

{% assign postCount = site.posts | size %}
{% assign postsCovered = site.paginate | plus:offset %}
{% if postsCovered < postCount %}
  <button class="loadMore">Load more posts</button>
{% endif %}

<script>
  {% include blog/pagination.js %}
</script>