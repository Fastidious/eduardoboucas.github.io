{% if paginator.page %}
  {% assign offset = paginator.page | minus:1 | times:paginator.per_page %}
  {% assign currentPage = paginator.page %}
{% else %}
  {% assign offset = 0 %}
  {% assign currentPage = 1 %}
{% endif %}

<div id="blogContainer" class="blogContainer {{ include.origin }}" data-page="{{ currentPage }}" data-totalPages="{{ paginator.total_pages }}">
  {% if include.origin == 'standalone' %}
    <p class="cta topLink"><a href="http://eduardoboucas.com" class="rightArrow">Visit main site</a></p>
  {% endif %}

  {% if include.origin == 'mainsite' %}
    <p class="cta topLink"><a href="http://eduardoboucas.com/blog" class="rightArrow">Open standalone version</a></p>
  {% endif %}

  {% for post in site.posts limit:site.paginate offset:offset %}
    <article class="post list">
      <header>
        <h1><a class="readPost" href="{{ post.url | prepend: site.baseurl }}">{{ post.title }}</a></h1>
        <p class="postMeta">
          <span class="date"><img src="/assets/images/icons/time.svg" class="postIcon"/> {{ post.date | date: "%b %-d, %Y" }}</span>
          {% if (post.tags and (include.origin != 'mainsite')) %}
            <span class="tags"><img src="/assets/images/icons/tag.svg" class="postIcon"/> {% for tag in post.tags %} <em><a href="/blog/tags.html#{{ tag }}">{{ tag }}</a></em>{% endfor %}</span>
          {% endif %}
          <span class="permalink"><img src="/assets/images/icons/link.svg" class="postIcon"/> <a href="{{ post.url }}">Permalink</a></span>
        </p>
      </header>
      <div class="excerpt">
        {% if post.content contains '<!--more-->' %}
          {{ post.content | split:'<!--more-->' | first }}
          <p class="cta"><a class="readPost rightArrow" href="{{ post.url }}">Read full post</a></p>
        {% else %}
          {{ post.content }}
        {% endif %}
      </div>
    </article>
  {% endfor %}
</div>

{% assign postCount = site.posts | size %}
{% assign postsCovered = site.paginate | plus:offset %}
{% if postsCovered < postCount %}
  <button class="loadMore">Load more posts</button>
{% endif %}